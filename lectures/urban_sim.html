<section>
    <h2><b>Urban Growth Models:</b></h2>
    <h3>From cellular automata to growing patches</h3>
    <p style="margin-top: 0.5em">
        Anna Petrasova, Vaclav Petras, Helena Mitasova</p>
    <p class="title-foot">
        GIS714 Geosimulations
        <a href="http://www.ncsu.edu/" title="North Carolina State University">NCSU</a>
    </p>
</section>

<section>
    <h3>Learning objectives</h3>
<p>
<ul>
    <li>evolution of urban growth models: from cellular automata to patch-based stochastic simulations
    <li>FUTURES modeling framework
    <li>demand and development potential
    <li>calibration
    <li>development pressure and patch growing algorithm
    <li>creating scenarios
</ul>
</section>

<section>
    <h3>Urban growth models evolution</h3>
<p>
<ul>
   <li>computational foundation: Tobler's Detroit growth model (1970), Conway's Game of life (1970) 
<p>
   <li class="fragment">rule-based cellular automata 
   <li class="fragment">probabilistic land change models
   <li class="fragment">coupling with agent-based models
   <li class="fragment">inputs, calibration and validation based on time series of RS and GIS data
</ul>
<p>
For comprehensive overview see Li and Gong, 2016, 
<a href="https://www.sciencedirect.com/science/article/pii/S2095927316305540">Urban growth models: progress and perspective</a>
</section>

<section>
    <h3>Cellular automata principle</h3>
<p>
Space is tesselated into grid cells with initial state $C_{i,j}^{t=0}$
<p>State of cell $(i,j)$ at time $t+\Delta t$ can be expressed as:
<p>
$$
C_{ij}^{t+\Delta t} = F(C_{ij}^{t}, O_{ij}^{t}, R)
$$
<p>where
<ul>
 <li>$C_{ij}^{t}$ is the cell state at time $t$, 
 <li>$O_{ij}^{t}$ is the state of cells in its neighborhood
 <li>$R$ represents transition rules 
 <li>note that $\Delta t$ is small 
</ul>
</section>

<section>
    <h3>Game of life</h3>
<p>Developed by Conway in 1970, the game has the following simple rules:
<small>
<ul>
  <li class="fragment">Any live cell with fewer than two live neighbours dies, as if by underpopulation.
<p>
  <li class="fragment">Any live cell with two or three live neighbours lives on to the next generation.
<p>
  <li class="fragment">Any live cell with more than three live neighbours dies, as if by overpopulation.
<p>
  <li class="fragment">Any dead cell with exactly three live neighbours becomes a live cell, as if by reproduction.
</ul>
</small>
<p class="fragment">
The resulting pattern is dependent only on the initial configuration:
example of <strong>emergence and self-organization </strong> leading to many
surprising evolution patterns
</section>

<section>
    <h3>Game of life examples</h3>
<p>
<a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">Game of life in wikipedia</a>: from simple 
still lifes and oscilators to complex and surprising evolution 
<p>
<a href="https://www.youtube.com/watch?v=C2vgICfQawE">Evolution of many different configurations</a> on YouTube
<p><img height="200" src="img/urban/Gospers_glider_gun_wikipedia.gif">
<p><small>Gosper glider by Kieff, CC BY-SA 3.0,<br>
 https://commons.wikimedia.org/w/index.php?curid=101736</small>
</section>

<section>
    <h3>Geospatial cellular automata</h3>
<p>
<ul>
  <li class="fragment">initial state is based on land use data, usually from RS or GIS
  <li class="fragment">rules are derived from socio-economic data and interactions between humans and environment 
  <li class="fragment">models are calibrated and validated using time series of land use data 
</ul>
</section>

<section>
   <h3>Tobler's Detroit growth model</h3>
<p>Cellular automata model with the spread rate estimated from actual population growth data 1930-1960.
<p> <img height="300" src="img/urban/Tobler_Detroit.png">
<p><small>W. R. Tobler (1970) A Computer Movie Simulating Urban Growth in the Detroit Region, 
Economic Geography, 46:sup1, 234-240, DOI: 10.2307/143141</small>
<p><small>In this paper Tobler invoked his famous first law of geography:
"everything is related to everything else, but near things are more related than distant things."</small>
</section>

<section>
    <h3>SLEUTH urban growth model</h3>
<p>
<ul>
  <li>couples Urban Growth Model and Land Cover Deltatron Model 
  <li>SLEUTH is an acronym for inputs: Slope, Land Cover, Excluded, Urban, Transportation, Hillshade
  <li>Urban areas behave like a living organism trained by transition rules:
<ul>
  <li class="fragment">class to class transition matrix derived from 2 LU maps
  <li class="fragment">time series of 4 urban maps is used for calibration
  <li class="fragment">parameters derived from past growth: dispersion, breed, spread, slope resistance, road gravity
  <li class="fragment">growth types: diffusive, new spreading center, organic, road influenced
</ul>
</ul>
<p class="fragment"><small>Learn more about SLEUTH at <a href="http://www.ncgia.ucsb.edu/projects/gig/index.html">Project Gigalopolis</a></small>
</section>

<section>
    <h3>Probabilistic CA urban growth models</h3>
<p>
<ul>
<li class="fragment">Special case of land change models
<li class="fragment">Probabilistic transition rules and a stochastic perturbation term
<li class="fragment">Statistical methods are used to develop the transition rules, based on past time series:
logistic regression, neural networks, decision trees
<li class="fragment">Beyond square grids: hexagons, irregular probabilistic patches
<li class="fragment">Interactions and spread beyond the immediate neighborhood
</ul>
</section>

<section>
<h3>FUTURES</h3>
FUTure Urban-Regional Environment Simulation,
<a href="http://dx.doi.org/10.1080/00045608.2012.707591">
Meentemeyer et al., 2013</a>
<div class="left" style="max-width: 60% !important">
<p>
<ul>
<li class="fragment">urban growth model</li>
<li class="fragment">patch-based</li>
<li class="fragment">stochastic</li>
<li class="fragment">accounts for location, quantity, pattern of change</li>
<li class="fragment">positive feedbacks (new development attracts more development)</li>
<li class="fragment">allows spatial non-stationarity</li>
</ul>
</div>

<img src="img/urban/cool_futures.png"  class="right" style="max-width: 38% !important">
</section>

<section>
<h3>FUTURES output</h3>
simulates where and when undeveloped cells (green) will turn into developed cells (shades of orange)
<br>
<img class="stretch" src="img/urban/r_futures_detail.png">
<p><small>
Numbers represent the year when the cell was developed since the start of simulation:
-1: undeveloped, 0: initial development, 1: developed in the first year, &hellip;
</small></p>
</section>

<section>
<h3>Modeling framework</h3>
<p>
<!--<img style="margin-top:2em;margin-left:5em; max-width: 58% !important;" src="img/urban/FUTURES_schema.png">-->
<img height="450" src="img/urban/FUTURES_schema.png">
<aside class="notes">
This is a basic schema of FUTURES, where the modeling framework is
based on 3 components: POTENTIAL submodel providing the information
where will urbanization likely happen, the DEMAND specifies how much
land will be developed and the third component PGA (meaning Patch Growing Algorithm)
is the actual engine of FUTURES, growing the patches of calibrated size and shape.
</aside>
</section>

<section class="textimg">
<h3>Demand submodel</h3>
<ul>
<li class="fragment">estimates the rate of per capita land consumption for
each subregion</li>
<li class="fragment">extrapolates between historical changes in population and land conversion</li>
<li class="fragment">inputs are historical landuse, population data, population projection</li>
<li class="fragment">output is land area that needs to be developed each year to satisfy the demand
driven by the population growth</li>
</ul>
<img src="img/urban/r_futures_demand_plot_logarithmic.png">
</section>

<section>
<h3>Demand scenarios</h3>
<div class="left" style="max-width: 65% !important">
<center>
<img width="32%" src="img/urban/r_futures_demand_plot_exponential.png">
<img width="32%" src="img/urban/r_futures_demand_plot_linear.png">
<img width="32%" src="img/urban/r_futures_demand_plot_logarithmic.png">
<img width="32%" src="img/urban/r_futures_demand_plot_logarithmic2.png">
<img width="32%" src="img/urban/r_futures_demand_plot_exp_approach.png">
</center>
</div>
<div class="right" style="font-size:70%; max-width: 30% !important">
<br>
<br>
$$
y = Ae^{BX} \\
y = A + Bx \\
y = A + B ln(x) \\
y = A + B ln(x - C) \\
y = (1 - e^{-A(x - B)}) + C
$$
</div>
</section>

<section>
<h3>Demand: population decline</h3>
<div class="left" style="max-width: 35% !important">
<center>
<img src="img/urban/r_futures_demand_negative.png">
</center>
</div>
<div class="right" style="max-width: 63% !important">
<ul>
    <li>demand submodel designed for regions with population growth</li>
    <li>FUTURES doesn't simulate cell de-conversion: here it would simulate zero new cell conversions</li>
    <li>even with population decline, impervious areas can increase</li>
</ul>
</div>
</section>

<section>
<h3>Modeling framework</h3>
<p>
<!--<img style="margin-top:2em;margin-left:5em; max-width: 58% !important;" src="img/urban/FUTURES_schema.png">-->
<img height="450" src="img/urban/FUTURES_schema.png">
<aside class="notes">
This is a basic schema of FUTURES, where the modeling framework is
based on 3 components: POTENTIAL submodel providing the information
where will urbanization likely happen, the DEMAND specifies how much
land will be developed and the third component PGA (meaning Patch Growing Algorithm)
is the actual engine of FUTURES, growing the patches of calibrated size and shape.
</aside>
</section>

<section>
<h3>Potential submodel</h3>
<ul>
<li>development suitability is estimated using multilevel logistic regression which
accounts for variation among subregions </li>
<li>inputs are uncorrelated predictors e.g., distance to roads, distance from existing development, slope, ...</li>
</ul>
<br>
<img src="img/urban/disttowaterlakes_zoom.png" height="280">
<img src="img/urban/r_futures_potsurface.png" height="280">
<p style="font-size:70%">Example predictors: distance to lakes, development pressure dependent on distance from developed areas
(orange: developed areas, green: undeveloped areas)
</section>

<section>
<h3>Development pressure</h3>
<ul>
    <li>Feedback between predicted change and change in subsequent steps</li>
    <li>Predictor based on number of neighboring developed cells within search distance, 
    weighted by distance: gravity model</li>
</ul>
$$pressure = \sum^{n_i}_{k=1} \frac{state_k} {d^{\gamma}_{ik}}$$
<ul>
<li> $state_k$ indicates whether neighboring cell $k$ is 1 or 0 (developed or undeveloped) <br>
<li> $d_{ik}$ is distance between cell $i$ and neighboring cell $k$ <br>
<li> $\gamma$ controls the influence of distance between neighboring cells</small>
</section>

<section>
<h3>Development pressure</h3>
Surface represents the development pressure, color is the initial development
<p><img src="img/urban/r_futures_devpressure_3D.png" height="400">
</section>

<section>
<h3>Development pressure 1992</h3>
<p><img src="img/urban/devpressure92.jpg" height="450">
</section>

<section>
<h3>Development pressure 2011</h3>
<p><img src="img/urban/devpressure2011.jpg" height="450">
</section>

<section>
<h3>Potential submodel</h3>
Predicts development potential for each cell as a function of predictor variables
using multilevel logistic regression
$$
s_i = a_{j,i} + \sum_{h=1}^{n} \beta_{j, i, h} \, x_{i, h}
$$
<ul>
  <li>$j$ is the level
  <li> $h$ is a predictor (e.g. development pressure, slope, ...)
  <li> $n$ is the number of predictor variables 
  <li> $a_{j,i}$ is intercept 
  <li> $\beta_{j, i, h}$ is regression coefficient 
  <li> $x_{i, h}$ is the value of $h$ at cell $i$
</ul>
To grow patches the development potential $s_i$ for cell $i$
is converted to development probability $p_i$
$$
p_i = \frac{e^{s_i}}{1 + e^{s_i}}
$$
</section>

<section>
<h3>Potential submodel: workflow</h3>
<ol>
    <li class="fragment">stratified random sampling of predictors and response variable (developed/undeveloped raster)</li>
    <li class="fragment">multilevel logistic regression to relate cell suitability factors (predictors)
        to its development potential for each subregion 
<!--
    <br><code>glm(developed ~ (1|subregion) + distance_to_water + development_pressure + road_density + ...)</code>
    <br>automatic model selection is based on Akaike information criterion (AIC)</li>
-->
    <li class="fragment">use the regression coefficients to compute the development potential
and development probability surface</li>
</ol>
</section>

<!--
<section>
<h3>Potential submodel: notes</h3>
    <ul>
        <li>predictors and coefficients do not change during simulation, except for development pressure</li>
        <li>avoid multicollinearity</li>
    </ul>
</section>
-->

<section>
<h3>Modeling framework</h3>
<p>
<!--<img style="margin-top:2em;margin-left:5em; max-width: 58% !important;" src="img/urban/FUTURES_schema.png">-->
<img height="450" src="img/urban/FUTURES_schema.png">
<aside class="notes">
This is a basic schema of FUTURES, where the modeling framework is
based on 3 components: POTENTIAL submodel providing the information
where will urbanization likely happen, the DEMAND specifies how much
land will be developed and the third component PGA (meaning Patch Growing Algorithm)
is the actual engine of FUTURES, growing the patches of calibrated size and shape.
</aside>
</section>


<section class="textimg">
<h3>Patch Growing Algorithm</h3>
<p>
<ul>
<li class="fragment">stochastic algorithm</li>
<li class="fragment">converts land in discrete patches</li>
<li class="fragment">inputs are patch characteristics (distribution of patch sizes and compactness)
derived from historical data</li>
</ul>
<img src="img/urban/PGA.gif">
</section>

<section>
<h3>Historical urban development data: 1992</h3>
<p><img src="img/urban/urban1992.png" height="450">
</section>

<section>
<h3>Historical urban development data 2001</h3>
<img src="img/urban/urban2001.png" height="450">
</section>

<section>
<h3>Historical urban development data 2006</h3>
<img src="img/urban/urban2006.png" height="450">
</section>

<section>
<h3>Historical urban development data 2011</h3>
<img src="img/urban/urban2011.png" height="450">
</section>

<section>
<h3>Patch Growing Algorithm</h3>
<ol>
    <li class="fragment">pick randomly a seed cell $i$</li>
    <li class="fragment">seed is established if $p_i$ &gt; random number</li>
    <li class="fragment">randomly pick patch size</li>
    <li class="fragment">grow patch</li>
        <ol>
            <li class="fragment">add neighbors ($p_j$) to a list and sort it based on $p_j / d_{ij}^c$, where $d_{ij}$ is distance from $i$ and $c$ is compactness value</li>
            <li class="fragment">pick first neighboring cell and try to add it to the patch if $p_j$ &gt; random number</li>
            <li class="fragment">if added, add surrounding neighboring cells to the list</li>
            <li class="fragment">repeat until the patch size is met</li>
        </ol>
    <li class="fragment">recompute development pressure</li>
</ol>
</section>

<section class="textimg">
<h3>Patch Compactness</h3>
<div>
    Low
<img src="img/urban/compactness_low.png">
</div>
<div>
    High
<img src="img/urban/compactness_high.png">
</div>
</section>

<section>
<h3>Scenarios: Incentive power</h3>
Transforms probability $p_i$ to $p_i^x$ to simulate infill vs. sprawl<br>
<img height="220" src="img/urban/incentive.png"><br>
<img height=250 src="img/urban/r_futures_scenario_infill.png">
<img height=250 src="img/urban/r_futures_scenario_status_quo.png">
<img height=250 src="img/urban/r_futures_scenario_sprawl.png">
</section>

<section>
    <h3>Scenarios</h3>
<em>Constraint</em> parameter: zones with decreased probability of development
$$P_{new} = P . C, \quad C \in \langle 0, 1\rangle $$

<br>
<em>Stimulus</em> parameter: zones with increased probability of development
$$P_{new} = P + S - P.S, \quad S \in \langle 0, 1 \rangle$$
</section>

<section>
<h3>r.futures</h3>
Information flow diagram for the set of FUTURES modules 
<p>
<img height=350 src="img/urban/grass_futures_diagram.png">
<p>
<a href="https://grass.osgeo.org/grass-stable/manuals/addons/r.futures.html">r.futures manual</a>
<p><small>
Additionally, <em>r.futures.parallelpga</em> can be used instead of <em>r.futures.pga</em>.
</small></p>
</section>

<section>
<h3>Visualization</h3>
Rendering the futures output in 3D using development type typology
<p>
<img height=450 src="img/urban/futures_anim.gif">
</section>

<section>
<iframe class="stretch" src="https://www.youtube.com/embed/SeBoGwSqmRM?rel=0" frameborder="0" allowfullscreen></iframe>
</section>


